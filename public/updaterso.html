<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Update RSO</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="shortcut icon" type="image/png" href="https://i.imgur.com/uNjEIJ5.png"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style type="text/css">
html,
body {
height: 100%;
position: relative;
}
.main-container {
min-height: 100vh;
overflow: hidden;
display: block;
position: relative;
padding-bottom: 400px;
}
.header {
background-color: #000;
height: 46px;
}
.headerlogo {
float: left;
margin-top: 7px;
}
.img {
border-style: none;
vertical-align: top;
max-width: 100%;
height: auto;
}
/*
.headerextras {
float: right;
margin-top: 13px;
padding-right: 45px;
font-size: 16;
}
*/
.footer {
position: absolute;
bottom: 0;
width: 100%;
left: 0;
width: 100%;
background-color: white;
color: black;
text-align: center;
font-size: 11;
}
hr {
border: 0;
height: 1px;
background: #333;
background-image: linear-gradient(to right, #ccc, #333, #ccc);
}
.dropbtn {
color: white;
background-color: #1d1d1d;
padding: 16px;
font-size: 16px;
border: none;
cursor: pointer;
}
.dropbtn:hover, .dropbtn:focus {
background-color: #f5cf00;
}
#myInput {
box-sizing: border-box;
background-image: url('searchicon.png');
background-position: 14px 12px;
background-repeat: no-repeat;
font-size: 16px;
padding: 14px 20px 12px 45px;
border: none;
border-bottom: 1px solid #ddd;
}
#myInput:focus {outline: 3px solid #ddd;}

.dropdown {
position: relative;
display: inline-block;
}
.dropdown-content {
display: none;
position: absolute;
background-color: #f6f6f6;
min-width: 230px;
overflow: auto;
border: 1px solid #ddd;
z-index: 1;
}
.dropdown-content a {
color: black;
padding: 12px 16px;
text-decoration: none;
display: block;
}
.dropdown a:hover {background-color: #ddd;}

.show {display: block;}

input[type=text], select {
width: 100%;
padding: 12px 20px;
margin: 8px 0;
display: inline-block;
border: 1px solid #ccc;
border-radius: 4px;
box-sizing: border-box;
}

input[type=submit] {
width: 100%;
color: white;
background-color: #1d1d1d;
padding: 14px 20px;
margin: 8px 0;
border: none;
border-radius: 4px;
cursor: pointer;
}
input[type=submit]:hover, input[type=submit]:focus {
background-color: #f5cf00;
}

.form {
border-radius: 5px;
background-color: #f2f2f2;
padding: 20px;

}
.selectButton {
box-shadow:inset 0px 0px 0px 0px #fff6af;
background:linear-gradient(to bottom, #ffec64 5%, #ffc124 100%);
background-color:#ffec64;
border:1px solid #ffc400;
display:inline-block;
cursor:pointer;
color:#000000;
font-family:Arial;
font-size:13px;
font-weight:bold;
padding:4px 8px .8px;
text-decoration:none;
text-shadow:0px 1px 0px #ffee66;
}
.selectButton:hover {
background:linear-gradient(to bottom, #ffc124 5%, #ffec64 100%);
background-color:#ffc124;
color:#000000;
}
.selectButton:active {
position:relative;
top:1px;
}
</style>
<div class="main-container">
  <div class="header">
    <div class="headerlogo">
      <a href="https://www.missouriwestern.edu/">
      <img src="https://www.missouriwestern.edu/student-life/wp-content/uploads/2017/09/mwsulogo3.png" alt="Missouri Western State University">
      </a>
    </div>
<!--
    <div class="headerextras">
      <a href="https://www.missouriwestern.edu/student-life/student-government-association/" target="_blank" style="color:#fec20a;">SGA Page
      </a>
    </div>
-->
  </div>
</head>
<body>
<div class="container-fluid">
    <div class="jumbotron">
        <div class="container">
            <h1 class="display-3">Update RSO</h1>
            <p>Update a current existing RSO account.</p>
        </div>
    </div>
    <div class="container">
            <div class="row">
                <form id = "selectrso">
                    <label for="RSO_NAME">Select RSO</label>
                    <p><select id="RSO_NAME" name = "RSO_NAME" placeholder="Search"></select>
                    <a button type= "submit" id="submit" name="submit" value="RSO_NAME" class="selectButton">Select</a></p>
                </form>

                <form id = "updaterso">
                    <input type = "hidden" id = "RSO_NAME_HIDDEN" name = "RSO_NAME_HIDDEN">

                    <label for="RSO_ADVISOR">RSO Advisor</label>
                    <p><input type="text" id="RSO_ADVISOR" name = "RSO_ADVISOR" placeholder="...">
                    </p>

                    <label for="ADVISOR_PHONE">Advisor Phone Number</label>
                    <p><input type="text" id="ADVISOR_PHONE" name = "ADVISOR_PHONE" placeholder="...">
                    </p>

                    <label for="ADVISOR_EMAIL">Advisor Email Address</label>
                    <p><input type="text" id="ADVISOR_EMAIL" name = "ADVISOR_EMAIL" placeholder="...">
                    </p>

                    <label for="RSO_NOTES">Notes</label>
                    <p><textarea id="RSO_NOTES" name = "RSO_NOTES" placeholder="  ..." cols="104" rows="10"></textarea>
                    </p>

                    <h4>Archive the RSO?</h4>
                    <input type="checkbox" id="ARCHIVE_YES" name="ARCHIVE_YES" value="Y"> Yes
                    </p>

                    <input type="submit"  class="dropbtn btn btn-default" value="Update RSO">
                 </form>
             </div>
    </div>


    <script>
      // Pull RSO Names data and assign it to #RSO_NAME
      $(document).ready(function(){
         $.ajax({
            url: '/sga/rso_names',
            method: 'GET',
            dataType: 'json',
            success: function(data){
               //console.log(data);
               for (key in data){
                  var text = data[key]
                  $('#RSO_NAME').append("<option>"+text+"</option>");
               }
            },
            error: function(jqXHR, textStatus, errorThrown){
               console.log(errorThrown);
            }
         })
      })

      var submitButton = document.getElementById('submit')
      var RSO_NAME = document.getElementById('RSO_NAME')
      var ARCHIVE_YES = document.getElementById('ARCHIVE_YES')

      submitButton.onclick = async(e) => {
        e.preventDefault();
        $.ajax({
              url: '/sga/rso_information',
              method: 'GET',
              dataType: 'json',
              data: {
                'RSO_NAME': RSO_NAME.value
              },
              success: function(data){
                console.log(data);
                $('#RSO_NAME_HIDDEN').val(RSO_NAME.value)
                $('#RSO_ADVISOR').val(data[0])
                $('#ADVISOR_PHONE').val(data[1])
                $('#ADVISOR_EMAIL').val(data[2])
                $('#RSO_NOTES').val(data[3])
                if (data[4] === 'Y') {
                  ARCHIVE_YES.checked = false;
                } else {
                  ARCHIVE_YES.checked = true;
                }
              },
              error: function(jqXHR, textStatus, errorThrown){
                console.log(errorThrown);
              }
          })
      }

      updaterso.onsubmit = async(e) => {
        e.preventDefault();

        var formData = new FormData(updaterso)

        formData.append("RSO_NAME_HIDDEN", $('#RSO_NAME_HIDDEN').val())
        formData.append("RSO_ADVISOR", $('#RSO_ADVISOR').val())
        formData.append("ADVISOR_PHONE", $('#ADVISOR_PHONE').val())
        formData.append("ADVISOR_EMAIL", $('#ADVISOR_EMAIL').val())
        formData.append("RSO_NOTES", $('#RSO_NOTES').val())
        formData.append("ARCHIVE_YES", $('#ARCHIVE_YES').val())

        let response = await fetch('/sga/updaterso.html', {
          method: 'POST',
          body: formData
        })

        let result = await response.json()

        alert(result.body, null)
      }

      // Keep checkboxes unchecked by default
      var checkboxes = document.getElementsByTagName('input');

      for (var i=0; i<checkboxes.length; i++)  {
        if (checkboxes[i].type == 'checkbox')   {
            checkboxes[i].checked = false;
        }
      }
    </script>


  <div class="footer">
    <hr width="80%">
      <p> Missouri Western State University <br>
      Student Government Association <br>
      4525 Downs Drive, St. Joseph, MO 64507 <br>
      &#9400; 2019 Missouri Western State University
      </p>
  </div>
</div>
</div> <!-- /.main-container-->
</body>
</html>